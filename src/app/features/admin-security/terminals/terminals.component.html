<div class="page-container">
  <div class="page-header">
    <div class="header-text">
      <h1><i class="bx bx-store"></i> {{ t.t('terminals.title') }}</h1>
      <p>{{ t.t('terminals.subtitle') }}</p>
    </div>
    <button class="btn btn-primary" (click)="openCreateModal()" [title]="t.t('terminals.newTerminal')">
      <i class="bx bx-plus"></i>
    </button>
  </div>

  <!-- Dashboard Stats -->
  @if (!loading()) {
    <div class="stats-grid">
      <div class="stat-card">
        <i class="bx bx-store stat-icon"></i>
        <div>
          <span class="stat-value">{{ terminals().length }}</span>
          <span class="stat-label">Total Terminals</span>
        </div>
      </div>
        <div class="stat-card">
          <i class="bx bx-check-circle stat-icon active"></i>
          <div>
            <span class="stat-value">{{ activeCount() }}</span>
            <span class="stat-label">Active</span>
          </div>
        </div>
        <div class="stat-card">
          <i class="bx bx-dock stat-icon"></i>
          <div>
            <span class="stat-value">{{ totalDockDoors() }}</span>
            <span class="stat-label">Total Dock Doors</span>
          </div>
        </div>
    </div>
  }

  @if (loading()) {
    <div class="loading-state">
      <i class="bx bx-loader-alt bx-spin"></i>
      <p>Loading terminals...</p>
    </div>
  }

  @if (!loading() && terminals().length > 0) {
    <div class="terminals-grid">
      @for (terminal of terminals(); track terminal.id) {
        <div class="terminal-card" [class]="terminal.status">
          <div class="card-header">
            <h3>{{ terminal.name }}</h3>
            <span class="type-badge">{{ terminal.type }}</span>
          </div>
          <div class="card-body">
            <p><i class="bx bx-map"></i> {{ terminal.city }}, {{ terminal.state }}</p>
            @if (terminal.satellite) {
              <p><i class="bx bx-building"></i> Satellite: {{ terminal.satellite.name }}</p>
            }
            @if (terminal.agency) {
              <p><i class="bx bx-buildings"></i> Agency: {{ terminal.agency.name }}</p>
            }
            @if (terminal.dockDoors) {
              <p><i class="bx bx-dock"></i> {{ terminal.dockDoors }} dock doors</p>
            }
          </div>
        </div>
      }
    </div>
  }
  
  @if (!loading() && terminals().length === 0) {
    <div class="empty-state">
      <i class="bx bx-store"></i>
      <h3>{{ t.t('terminals.noTerminalsFound') }}</h3>
      <p>{{ t.t('terminals.createFirstTerminal') }}</p>
      <button class="btn btn-primary" (click)="openCreateModal()" [title]="t.t('terminals.createTerminal')">
        <i class="bx bx-plus"></i>
      </button>
    </div>
  }
  
  <!-- Create Terminal Modal -->
  @if (showModal()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2><i class="bx bx-store"></i> Create Terminal</h2>
          <button class="btn-close" (click)="closeModal()"><i class="bx bx-x"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-grid">
            <div class="form-group full-width">
              <label>Organization *</label>
              <select [(ngModel)]="form.organizationId" required>
                <option [ngValue]="null">Select Organization</option>
                @for (org of organizations(); track org.id) {
                  <option [ngValue]="org.id">{{ org.name }}</option>
                }
              </select>
            </div>
            <div class="form-group full-width">
              <label>Terminal Name *</label>
              <input type="text" [(ngModel)]="form.name" placeholder="Los Angeles Warehouse">
            </div>
            <div class="form-group">
              <label>Code</label>
              <input type="text" [(ngModel)]="form.code" placeholder="TRM-LA">
            </div>
            <div class="form-group">
              <label>Type *</label>
              <select [(ngModel)]="form.type">
                <option value="warehouse">Warehouse</option>
                <option value="port">Port</option>
                <option value="distribution_center">Distribution Center</option>
                <option value="cross_dock">Cross Dock</option>
                <option value="yard">Yard</option>
              </select>
            </div>
            <div class="form-group full-width">
              <label>Address *</label>
              <input type="text" [(ngModel)]="form.address" placeholder="Start typing address...">
            </div>
            <div class="form-group">
              <label>City *</label>
              <input type="text" [(ngModel)]="form.city">
            </div>
            <div class="form-group">
              <label>State *</label>
              <select [(ngModel)]="form.state" required>
                <option value="">Select State</option>
                @for (state of states; track state.code) {
                  <option [value]="state.code">{{ state.name }} ({{ state.code }})</option>
                }
              </select>
            </div>
            <div class="form-group">
              <label>ZIP Code *</label>
              <input type="text" [(ngModel)]="form.zipCode">
            </div>
            <div class="form-group">
              <label>Status</label>
              <select [(ngModel)]="form.status">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
                <option value="maintenance">Maintenance</option>
                <option value="closed">Closed</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
          <button class="btn btn-primary" (click)="save()"><i class="bx bx-save"></i> Create</button>
        </div>
      </div>
    </div>
  }
</div>
